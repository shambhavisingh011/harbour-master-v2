
PLAY [Phase 1 - Prepare All Nodes] *********************************************

TASK [Gathering Facts] *********************************************************
[1;35m[WARNING]: Host 'db-node-01' is using the discovered Python interpreter at '/usr/bin/python3.12', but future installation of another Python interpreter could cause a different interpreter to be discovered. See https://docs.ansible.com/ansible-core/2.20/reference_appendices/interpreter_discovery.html for more information.[0m
[0;32mok: [db-node-01][0m
[1;35m[WARNING]: Host 'async-node' is using the discovered Python interpreter at '/usr/bin/python3.12', but future installation of another Python interpreter could cause a different interpreter to be discovered. See https://docs.ansible.com/ansible-core/2.20/reference_appendices/interpreter_discovery.html for more information.[0m
[0;32mok: [async-node][0m

TASK [Wait for apt lock to be released] ****************************************
[0;33mchanged: [async-node][0m
[0;33mchanged: [db-node-01][0m

TASK [Install basic utilities] *************************************************
[0;32mok: [db-node-01][0m
[0;32mok: [async-node][0m

PLAY [Phase 1 - Prepare All Nodes] *********************************************

TASK [Gathering Facts] *********************************************************
[1;35m[WARNING]: Host 'db-node-02' is using the discovered Python interpreter at '/usr/bin/python3.12', but future installation of another Python interpreter could cause a different interpreter to be discovered. See https://docs.ansible.com/ansible-core/2.20/reference_appendices/interpreter_discovery.html for more information.[0m
[0;32mok: [db-node-02][0m
[1;35m[WARNING]: Host 'db-node-03' is using the discovered Python interpreter at '/usr/bin/python3.12', but future installation of another Python interpreter could cause a different interpreter to be discovered. See https://docs.ansible.com/ansible-core/2.20/reference_appendices/interpreter_discovery.html for more information.[0m
[0;32mok: [db-node-03][0m

TASK [Wait for apt lock to be released] ****************************************
[0;33mchanged: [db-node-02][0m
[0;33mchanged: [db-node-03][0m

TASK [Install basic utilities] *************************************************
[0;32mok: [db-node-02][0m
[0;32mok: [db-node-03][0m

PLAY [Phase 1 - Prepare All Nodes] *********************************************

TASK [Gathering Facts] *********************************************************
[1;35m[WARNING]: Host 'lvs-node-2' is using the discovered Python interpreter at '/usr/bin/python3.12', but future installation of another Python interpreter could cause a different interpreter to be discovered. See https://docs.ansible.com/ansible-core/2.20/reference_appendices/interpreter_discovery.html for more information.[0m
[0;32mok: [lvs-node-2][0m
[1;35m[WARNING]: Host 'lvs-node-1' is using the discovered Python interpreter at '/usr/bin/python3.12', but future installation of another Python interpreter could cause a different interpreter to be discovered. See https://docs.ansible.com/ansible-core/2.20/reference_appendices/interpreter_discovery.html for more information.[0m
[0;32mok: [lvs-node-1][0m

TASK [Wait for apt lock to be released] ****************************************
[0;33mchanged: [lvs-node-1][0m
[0;33mchanged: [lvs-node-2][0m

TASK [Install basic utilities] *************************************************
[0;32mok: [lvs-node-1][0m
[0;32mok: [lvs-node-2][0m

PLAY [Phase 1 - Prepare All Nodes] *********************************************

TASK [Gathering Facts] *********************************************************
[1;35m[WARNING]: Host 'monitor-node' is using the discovered Python interpreter at '/usr/bin/python3.12', but future installation of another Python interpreter could cause a different interpreter to be discovered. See https://docs.ansible.com/ansible-core/2.20/reference_appendices/interpreter_discovery.html for more information.[0m
[0;32mok: [monitor-node][0m

TASK [Wait for apt lock to be released] ****************************************
[0;33mchanged: [monitor-node][0m

TASK [Install basic utilities] *************************************************
[0;32mok: [monitor-node][0m

PLAY [Phase 2 - Setup MariaDB Repositories] ************************************

TASK [Gathering Facts] *********************************************************
[0;32mok: [db-node-02][0m
[0;32mok: [db-node-01][0m

TASK [common : Update apt cache] ***********************************************
[0;33mchanged: [db-node-01][0m
[0;33mchanged: [db-node-02][0m

TASK [common : Install dependencies] *******************************************
[0;32mok: [db-node-01][0m
[0;32mok: [db-node-02][0m

TASK [common : Add MariaDB GPG key] ********************************************
[0;32mok: [db-node-02][0m
[0;32mok: [db-node-01][0m

TASK [common : Add MariaDB Repository for version 10.11] ***********************
[1;35m[WARNING]: Deprecation warnings can be disabled by setting `deprecation_warnings=False` in ansible.cfg.[0m
[0;35m[0m
[0;32mok: [db-node-02][0m
[0;32mok: [db-node-01][0m

TASK [common : Update apt cache after adding repo] *****************************
[0;33mchanged: [db-node-02][0m
[0;33mchanged: [db-node-01][0m

PLAY [Phase 2 - Setup MariaDB Repositories] ************************************

TASK [Gathering Facts] *********************************************************
[0;32mok: [db-node-03][0m
[0;32mok: [async-node][0m

TASK [common : Update apt cache] ***********************************************
[0;33mchanged: [db-node-03][0m
[0;33mchanged: [async-node][0m

TASK [common : Install dependencies] *******************************************
[0;32mok: [db-node-03][0m
[0;32mok: [async-node][0m

TASK [common : Add MariaDB GPG key] ********************************************
[0;32mok: [db-node-03][0m
[0;32mok: [async-node][0m

TASK [common : Add MariaDB Repository for version 10.11] ***********************
[0;32mok: [db-node-03][0m
[0;32mok: [async-node][0m

TASK [common : Update apt cache after adding repo] *****************************
[0;33mchanged: [db-node-03][0m
[0;33mchanged: [async-node][0m

PLAY [Phase 3 - Build Galera Cluster] ******************************************

TASK [Gathering Facts] *********************************************************
[0;32mok: [db-node-01][0m

TASK [galera : Install MariaDB Server and Galera dependencies] *****************
[0;32mok: [db-node-01][0m

TASK [galera : Stop MariaDB to prevent standalone mode conflicts] **************
[0;33mchanged: [db-node-01][0m

TASK [galera : Disable default bind-address in 50-server.cnf] ******************
[0;32mok: [db-node-01][0m

TASK [galera : Deploy Galera Configuration] ************************************
[0;32mok: [db-node-01][0m

TASK [galera : Initialize MariaDB data directory if empty] *********************
[0;32mok: [db-node-01][0m

TASK [galera : Check if grastate.dat exists] ***********************************
[0;32mok: [db-node-01][0m

TASK [galera : Set safe_to_bootstrap flag in grastate.dat] *********************
[0;32mok: [db-node-01][0m

TASK [galera : Execute Galera New Cluster command] *****************************
[0;33mchanged: [db-node-01][0m

TASK [galera : Wait for Primary Node to be ready] ******************************
[0;32mok: [db-node-01][0m

TASK [galera : Join Secondary Nodes to Cluster] ********************************
[0;36mskipping: [db-node-01][0m

TASK [galera : [Self-Healing] Check if Node is stuck in Initialized state] *****
[0;32mok: [db-node-01][0m

TASK [galera : [Self-Healing] Force Restart stuck node to trigger Re-Join] *****
[0;36mskipping: [db-node-01][0m

TASK [galera : [Self-Healing] Emergency - Force Bootstrap if Node 1 is partitioned] ***
[0;36mskipping: [db-node-01][0m

TASK [galera : [Self-Healing] Wait for Node to finish IST/SST and Sync] ********
[0;32mok: [db-node-01][0m

TASK [galera : Final Verification of Cluster Connectivity] *********************
[0;33mchanged: [db-node-01][0m

TASK [galera : Ensure dummy network module is loaded] **************************
[0;32mok: [db-node-01][0m

TASK [galera : Create dummy0 network interface] ********************************
[0;33mchanged: [db-node-01][0m

TASK [galera : Deploy HCIP Management Script] **********************************
[0;32mok: [db-node-01][0m

TASK [galera : Run HCIP Manager to initialize state] ***************************
[0;33mchanged: [db-node-01][0m

TASK [galera : Add HCIP Manager to Crontab for persistence] ********************
[0;32mok: [db-node-01][0m

TASK [galera : Create SST User for replication] ********************************
[0;35m[DEPRECATION WARNING]: Importing 'to_native' from 'ansible.module_utils._text' is deprecated. This feature will be removed from ansible-core version 2.24. Use ansible.module_utils.common.text.converters instead.[0m
[0;32mok: [db-node-01][0m

TASK [galera : Create Replication User for Async Node] *************************
[0;32mok: [db-node-01][0m

TASK [galera : Allow Root Access from Remote Network] **************************
[0;32mok: [db-node-01] => (item=%)[0m
[0;32mok: [db-node-01] => (item=localhost)[0m

PLAY [Phase 3 - Build Galera Cluster] ******************************************

TASK [Gathering Facts] *********************************************************
[0;32mok: [db-node-02][0m

TASK [galera : Install MariaDB Server and Galera dependencies] *****************
[0;32mok: [db-node-02][0m

TASK [galera : Stop MariaDB to prevent standalone mode conflicts] **************
[0;33mchanged: [db-node-02][0m

TASK [galera : Disable default bind-address in 50-server.cnf] ******************
[0;32mok: [db-node-02][0m

TASK [galera : Deploy Galera Configuration] ************************************
[0;32mok: [db-node-02][0m

TASK [galera : Initialize MariaDB data directory if empty] *********************
[0;32mok: [db-node-02][0m

TASK [galera : Check if grastate.dat exists] ***********************************
[0;32mok: [db-node-02][0m

TASK [galera : Set safe_to_bootstrap flag in grastate.dat] *********************
[0;36mskipping: [db-node-02][0m

TASK [galera : Execute Galera New Cluster command] *****************************
[0;36mskipping: [db-node-02][0m

TASK [galera : Wait for Primary Node to be ready] ******************************
[0;36mskipping: [db-node-02][0m

TASK [galera : Join Secondary Nodes to Cluster] ********************************
[0;33mchanged: [db-node-02][0m

TASK [galera : [Self-Healing] Check if Node is stuck in Initialized state] *****
[0;32mok: [db-node-02][0m

TASK [galera : [Self-Healing] Force Restart stuck node to trigger Re-Join] *****
[0;36mskipping: [db-node-02][0m

TASK [galera : [Self-Healing] Emergency - Force Bootstrap if Node 1 is partitioned] ***
[0;36mskipping: [db-node-02][0m

TASK [galera : [Self-Healing] Wait for Node to finish IST/SST and Sync] ********
[0;32mok: [db-node-02][0m

TASK [galera : Final Verification of Cluster Connectivity] *********************
[0;33mchanged: [db-node-02][0m

TASK [galera : Ensure dummy network module is loaded] **************************
[0;32mok: [db-node-02][0m

TASK [galera : Create dummy0 network interface] ********************************
[0;33mchanged: [db-node-02][0m

TASK [galera : Deploy HCIP Management Script] **********************************
[0;32mok: [db-node-02][0m

TASK [galera : Run HCIP Manager to initialize state] ***************************
[0;33mchanged: [db-node-02][0m

TASK [galera : Add HCIP Manager to Crontab for persistence] ********************
[0;32mok: [db-node-02][0m

TASK [galera : Create SST User for replication] ********************************
[0;32mok: [db-node-02][0m

TASK [galera : Create Replication User for Async Node] *************************
[0;32mok: [db-node-02][0m

TASK [galera : Allow Root Access from Remote Network] **************************
[0;32mok: [db-node-02] => (item=%)[0m
[0;32mok: [db-node-02] => (item=localhost)[0m

PLAY [Phase 3 - Build Galera Cluster] ******************************************

TASK [Gathering Facts] *********************************************************
[0;32mok: [db-node-03][0m

TASK [galera : Install MariaDB Server and Galera dependencies] *****************
[0;32mok: [db-node-03][0m

TASK [galera : Stop MariaDB to prevent standalone mode conflicts] **************
[0;33mchanged: [db-node-03][0m

TASK [galera : Disable default bind-address in 50-server.cnf] ******************
[0;32mok: [db-node-03][0m

TASK [galera : Deploy Galera Configuration] ************************************
[0;32mok: [db-node-03][0m

TASK [galera : Initialize MariaDB data directory if empty] *********************
[0;32mok: [db-node-03][0m

TASK [galera : Check if grastate.dat exists] ***********************************
[0;32mok: [db-node-03][0m

TASK [galera : Set safe_to_bootstrap flag in grastate.dat] *********************
[0;36mskipping: [db-node-03][0m

TASK [galera : Execute Galera New Cluster command] *****************************
[0;36mskipping: [db-node-03][0m

TASK [galera : Wait for Primary Node to be ready] ******************************
[0;36mskipping: [db-node-03][0m

TASK [galera : Join Secondary Nodes to Cluster] ********************************
[1;30mFAILED - RETRYING: [db-node-03]: Join Secondary Nodes to Cluster (5 retries left).[0m
[0;32mok: [db-node-03][0m

TASK [galera : [Self-Healing] Check if Node is stuck in Initialized state] *****
[0;31m[ERROR]: Task failed: Module failed: non-zero return code[0m
[0;31mOrigin: /home/ubuntu/harbour-master/backend/ansible/roles/galera/tasks/main.yml:87:3[0m
[0;31m[0m
[0;31m85[0m
[0;31m86 # 7. AUTOMATED HEALTH CHECK & SELF-HEALING[0m
[0;31m87 - name: "[Self-Healing] Check if Node is stuck in Initialized state"[0m
[0;31m     ^ column 3[0m
[0;31m[0m
[0;31mfatal: [db-node-03]: FAILED! => {"changed": false, "cmd": "mariadb -u root -p'StrongPass123!' -N -s -e \"SHOW STATUS LIKE 'wsrep_local_state_comment';\"\n", "delta": "0:00:00.003309", "end": "2026-02-15 02:02:47.932484", "msg": "non-zero return code", "rc": 1, "start": "2026-02-15 02:02:47.929175", "stderr": "ERROR 2002 (HY000): Can't connect to local server through socket '/run/mysqld/mysqld.sock' (111)", "stderr_lines": ["ERROR 2002 (HY000): Can't connect to local server through socket '/run/mysqld/mysqld.sock' (111)"], "stdout": "", "stdout_lines": []}[0m
[0;36m...ignoring[0m

TASK [galera : [Self-Healing] Force Restart stuck node to trigger Re-Join] *****
[0;36mskipping: [db-node-03][0m

TASK [galera : [Self-Healing] Emergency - Force Bootstrap if Node 1 is partitioned] ***
[0;36mskipping: [db-node-03][0m

TASK [galera : [Self-Healing] Wait for Node to finish IST/SST and Sync] ********
[1;30mFAILED - RETRYING: [db-node-03]: [Self-Healing] Wait for Node to finish IST/SST and Sync (20 retries left).[0m
[1;30mFAILED - RETRYING: [db-node-03]: [Self-Healing] Wait for Node to finish IST/SST and Sync (19 retries left).[0m
[1;30mFAILED - RETRYING: [db-node-03]: [Self-Healing] Wait for Node to finish IST/SST and Sync (18 retries left).[0m
[1;30mFAILED - RETRYING: [db-node-03]: [Self-Healing] Wait for Node to finish IST/SST and Sync (17 retries left).[0m
[1;30mFAILED - RETRYING: [db-node-03]: [Self-Healing] Wait for Node to finish IST/SST and Sync (16 retries left).[0m
[1;30mFAILED - RETRYING: [db-node-03]: [Self-Healing] Wait for Node to finish IST/SST and Sync (15 retries left).[0m
[1;30mFAILED - RETRYING: [db-node-03]: [Self-Healing] Wait for Node to finish IST/SST and Sync (14 retries left).[0m
[1;30mFAILED - RETRYING: [db-node-03]: [Self-Healing] Wait for Node to finish IST/SST and Sync (13 retries left).[0m
[1;30mFAILED - RETRYING: [db-node-03]: [Self-Healing] Wait for Node to finish IST/SST and Sync (12 retries left).[0m
[1;30mFAILED - RETRYING: [db-node-03]: [Self-Healing] Wait for Node to finish IST/SST and Sync (11 retries left).[0m
[1;30mFAILED - RETRYING: [db-node-03]: [Self-Healing] Wait for Node to finish IST/SST and Sync (10 retries left).[0m
[1;30mFAILED - RETRYING: [db-node-03]: [Self-Healing] Wait for Node to finish IST/SST and Sync (9 retries left).[0m
[1;30mFAILED - RETRYING: [db-node-03]: [Self-Healing] Wait for Node to finish IST/SST and Sync (8 retries left).[0m
[1;30mFAILED - RETRYING: [db-node-03]: [Self-Healing] Wait for Node to finish IST/SST and Sync (7 retries left).[0m
[1;30mFAILED - RETRYING: [db-node-03]: [Self-Healing] Wait for Node to finish IST/SST and Sync (6 retries left).[0m
