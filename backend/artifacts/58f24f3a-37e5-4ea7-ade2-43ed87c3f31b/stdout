
PLAY [Phase 0 - Infrastructure Handshake Preparation] **************************

TASK [Ensure LVS files directory exists] ***************************************
[0;32mok: [localhost][0m

TASK [Generate SSH keypair for LVS Health Checks] ******************************
[0;32mok: [localhost][0m

PLAY [Phase 1 - Prepare All Nodes] *********************************************

TASK [Gathering Facts] *********************************************************
[1;35m[WARNING]: Host 'db-node-01' is using the discovered Python interpreter at '/usr/bin/python3.12', but future installation of another Python interpreter could cause a different interpreter to be discovered. See https://docs.ansible.com/ansible-core/2.20/reference_appendices/interpreter_discovery.html for more information.[0m
[0;32mok: [db-node-01][0m
[1;35m[WARNING]: Host 'async-node' is using the discovered Python interpreter at '/usr/bin/python3.12', but future installation of another Python interpreter could cause a different interpreter to be discovered. See https://docs.ansible.com/ansible-core/2.20/reference_appendices/interpreter_discovery.html for more information.[0m
[0;32mok: [async-node][0m

TASK [Wait for apt lock to be released] ****************************************
[0;33mchanged: [db-node-01][0m
[0;33mchanged: [async-node][0m

TASK [Install basic utilities] *************************************************
[0;32mok: [async-node][0m
[0;32mok: [db-node-01][0m

PLAY [Phase 1 - Prepare All Nodes] *********************************************

TASK [Gathering Facts] *********************************************************
[1;35m[WARNING]: Host 'db-node-02' is using the discovered Python interpreter at '/usr/bin/python3.12', but future installation of another Python interpreter could cause a different interpreter to be discovered. See https://docs.ansible.com/ansible-core/2.20/reference_appendices/interpreter_discovery.html for more information.[0m
[0;32mok: [db-node-02][0m
[1;35m[WARNING]: Host 'db-node-03' is using the discovered Python interpreter at '/usr/bin/python3.12', but future installation of another Python interpreter could cause a different interpreter to be discovered. See https://docs.ansible.com/ansible-core/2.20/reference_appendices/interpreter_discovery.html for more information.[0m
[0;32mok: [db-node-03][0m

TASK [Wait for apt lock to be released] ****************************************
[0;33mchanged: [db-node-02][0m
[0;33mchanged: [db-node-03][0m

TASK [Install basic utilities] *************************************************
[0;32mok: [db-node-03][0m
[0;32mok: [db-node-02][0m

PLAY [Phase 1 - Prepare All Nodes] *********************************************

TASK [Gathering Facts] *********************************************************
[1;35m[WARNING]: Host 'lvs-node-2' is using the discovered Python interpreter at '/usr/bin/python3.12', but future installation of another Python interpreter could cause a different interpreter to be discovered. See https://docs.ansible.com/ansible-core/2.20/reference_appendices/interpreter_discovery.html for more information.[0m
[0;32mok: [lvs-node-2][0m
[1;35m[WARNING]: Host 'lvs-node-1' is using the discovered Python interpreter at '/usr/bin/python3.12', but future installation of another Python interpreter could cause a different interpreter to be discovered. See https://docs.ansible.com/ansible-core/2.20/reference_appendices/interpreter_discovery.html for more information.[0m
[0;32mok: [lvs-node-1][0m

TASK [Wait for apt lock to be released] ****************************************
[0;33mchanged: [lvs-node-1][0m
[0;33mchanged: [lvs-node-2][0m

TASK [Install basic utilities] *************************************************
[0;32mok: [lvs-node-1][0m
[0;32mok: [lvs-node-2][0m

PLAY [Phase 1 - Prepare All Nodes] *********************************************

TASK [Gathering Facts] *********************************************************
[1;35m[WARNING]: Host 'monitor-node' is using the discovered Python interpreter at '/usr/bin/python3.12', but future installation of another Python interpreter could cause a different interpreter to be discovered. See https://docs.ansible.com/ansible-core/2.20/reference_appendices/interpreter_discovery.html for more information.[0m
[0;32mok: [monitor-node][0m

TASK [Wait for apt lock to be released] ****************************************
[0;33mchanged: [monitor-node][0m

TASK [Install basic utilities] *************************************************
[0;32mok: [monitor-node][0m

PLAY [Phase 2 - Setup MariaDB Repositories] ************************************

TASK [Gathering Facts] *********************************************************
[0;32mok: [db-node-02][0m
[0;32mok: [db-node-01][0m

TASK [common : Check if MariaDB is already installed] **************************
[0;32mok: [db-node-01][0m
[0;32mok: [db-node-02][0m

TASK [common : Extract installed version string] *******************************
[0;36mskipping: [db-node-02][0m
[0;32mok: [db-node-01][0m

TASK [common : Block execution if versions mismatch] ***************************
[0;31m[ERROR]: Task failed: Action failed: Safety Stop: You requested MariaDB 10.11, but version 15.1 is already installed. Downgrades/Upgrades are not allowed via this playbook.[0m
[0;31mOrigin: /home/ubuntu/harbour-master/backend/ansible/roles/common/tasks/main.yml:13:3[0m
[0;31m[0m
[0;31m11   when: mariadb_check.rc == 0[0m
[0;31m12[0m
[0;31m13 - name: Block execution if versions mismatch[0m
[0;31m     ^ column 3[0m
[0;31m[0m
[0;31mfatal: [db-node-01]: FAILED! => {"changed": false, "msg": "Safety Stop: You requested MariaDB 10.11, but version 15.1 is already installed. Downgrades/Upgrades are not allowed via this playbook."}[0m
[0;36mskipping: [db-node-02][0m

TASK [common : Update apt cache] ***********************************************
[0;32mok: [db-node-02][0m

TASK [common : Install dependencies] *******************************************
[0;32mok: [db-node-02][0m

TASK [common : Add MariaDB GPG key] ********************************************
[0;32mok: [db-node-02][0m

TASK [common : Add MariaDB Repository] *****************************************
[0;35m[0m
[0;32mok: [db-node-02][0m

PLAY [Phase 2 - Setup MariaDB Repositories] ************************************

TASK [Gathering Facts] *********************************************************
[0;32mok: [db-node-03][0m
[0;32mok: [async-node][0m

TASK [common : Check if MariaDB is already installed] **************************
[0;32mok: [db-node-03][0m
[0;32mok: [async-node][0m

TASK [common : Extract installed version string] *******************************
[0;36mskipping: [db-node-03][0m
[0;36mskipping: [async-node][0m

TASK [common : Block execution if versions mismatch] ***************************
[0;36mskipping: [db-node-03][0m
[0;36mskipping: [async-node][0m

TASK [common : Update apt cache] ***********************************************
[0;32mok: [db-node-03][0m
[0;32mok: [async-node][0m

TASK [common : Install dependencies] *******************************************
[0;32mok: [db-node-03][0m
[0;32mok: [async-node][0m

TASK [common : Add MariaDB GPG key] ********************************************
[0;32mok: [db-node-03][0m
[0;32mok: [async-node][0m

TASK [common : Add MariaDB Repository] *****************************************
[0;32mok: [db-node-03][0m
[0;32mok: [async-node][0m

PLAY [Phase 3 - Build Galera Cluster] ******************************************

PLAY [Phase 3 - Build Galera Cluster] ******************************************

TASK [Gathering Facts] *********************************************************
[0;32mok: [db-node-02][0m

TASK [galera : GUARD: Check if MariaDB service is active] **********************
[0;32mok: [db-node-02][0m

TASK [galera : GUARD: Check if this node currently holds the HCIP (Master)] ****
[0;32mok: [db-node-02][0m

TASK [galera : LOGIC: Define Local Safety Facts] *******************************
[0;32mok: [db-node-02][0m

TASK [galera : LOGIC: Share Master Status across all nodes] ********************
[0;31m[ERROR]: Task failed: Finalization of task args for 'ansible.builtin.set_fact' failed: Error while resolving value for 'cluster_has_active_master': object of type 'HostVarsVars' has no attribute 'is_current_master'[0m
[0;31m[0m
[0;31mTask failed.[0m
[0;31mOrigin: /home/ubuntu/harbour-master/backend/ansible/roles/galera/tasks/main.yml:24:3[0m
[0;31m[0m
[0;31m22     is_current_master: "{{ hcip_check.rc == 0 }}"[0m
[0;31m23[0m
[0;31m24 - name: "LOGIC: Share Master Status across all nodes"[0m
[0;31m     ^ column 3[0m
[0;31m[0m
[0;31m<<< caused by >>>[0m
[0;31m[0m
[0;31mFinalization of task args for 'ansible.builtin.set_fact' failed.[0m
[0;31mOrigin: /home/ubuntu/harbour-master/backend/ansible/roles/galera/tasks/main.yml:25:3[0m
[0;31m[0m
[0;31m23[0m
[0;31m24 - name: "LOGIC: Share Master Status across all nodes"[0m
[0;31m25   set_fact:[0m
[0;31m     ^ column 3[0m
[0;31m[0m
[0;31m<<< caused by >>>[0m
[0;31m[0m
[0;31mError while resolving value for 'cluster_has_active_master': object of type 'HostVarsVars' has no attribute 'is_current_master'[0m
[0;31mOrigin: /home/ubuntu/harbour-master/backend/ansible/roles/galera/tasks/main.yml:26:32[0m
[0;31m[0m
[0;31m24 - name: "LOGIC: Share Master Status across all nodes"[0m
[0;31m25   set_fact:[0m
[0;31m26     cluster_has_active_master: "{{ groups['galera'] | map('extract', hostvars, 'is_current_master') | select('equa...[0m
[0;31m                                  ^ column 32[0m
[0;31m[0m
[0;31mfatal: [db-node-02]: FAILED! => {"changed": false, "msg": "Task failed: Finalization of task args for 'ansible.builtin.set_fact' failed: Error while resolving value for 'cluster_has_active_master': object of type 'HostVarsVars' has no attribute 'is_current_master'"}[0m

PLAY RECAP *********************************************************************
[0;33masync-node[0m                 : [0;32mok=9   [0m [0;33mchanged=1   [0m unreachable=0    failed=0    [0;36mskipped=2   [0m rescued=0    ignored=0   
[0;31mdb-node-01[0m                 : [0;32mok=6   [0m [0;33mchanged=1   [0m unreachable=0    [0;31mfailed=1   [0m skipped=0    rescued=0    ignored=0   
[0;31mdb-node-02[0m                 : [0;32mok=13  [0m [0;33mchanged=1   [0m unreachable=0    [0;31mfailed=1   [0m [0;36mskipped=2   [0m rescued=0    ignored=0   
[0;33mdb-node-03[0m                 : [0;32mok=9   [0m [0;33mchanged=1   [0m unreachable=0    failed=0    [0;36mskipped=2   [0m rescued=0    ignored=0   
[0;32mlocalhost[0m                  : [0;32mok=2   [0m changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
[0;33mlvs-node-1[0m                 : [0;32mok=3   [0m [0;33mchanged=1   [0m unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
[0;33mlvs-node-2[0m                 : [0;32mok=3   [0m [0;33mchanged=1   [0m unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
[0;33mmonitor-node[0m               : [0;32mok=3   [0m [0;33mchanged=1   [0m unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
